<!DOCTYPE html>
<html lang="en" dir="rtl">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="description" content="A fully featured admin theme which can be used to build CRM, CMS, etc.">
    <meta name="author" content="Coderthemes">
    <script src="../../assets/js/changes/constants.js"></script>
    <link rel="shortcut icon" href="../assets/images/favicon.ico">

    <title>TmanaGement-Login</title>

    <!-- Sweet Alert css -->
    <link href="../assets/plugins/sweet-alert/sweetalert2.min.css" rel="stylesheet" type="text/css" />

    <link href="../assets/plugins/switchery/switchery.min.css" rel="stylesheet" />
    <link href="../assets/plugins/jquery-circliful/css/jquery.circliful.css" rel="stylesheet" type="text/css" />

    <link href="../assets/css/bootstrap.min.css" rel="stylesheet" type="text/css">
    <link href="../assets/css/icons.css" rel="stylesheet" type="text/css">
    <link href="../assets/css/style.css" rel="stylesheet" type="text/css">

    <script src="../assets/js/external_utils/modernizr.min.js"></script>

    <link href="../assets/css/bootstrap.min.css" rel="stylesheet" type="text/css">
    <link href="../assets/css/icons.css" rel="stylesheet" type="text/css">
    <link href="../assets/css/style.css" rel="stylesheet" type="text/css">

    <script src="../assets/js/external_utils/jquery.min.js"></script>

    <script src="../assets/js/external_utils/modernizr.min.js"></script>

    <script src="../assets/js/changes/ajaxCalls.js"></script>
    <script src="../assets/js/changes/CookiesFunctions.js"></script>

    <link href="../assets/css/changes.css" rel="stylesheet" />
    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
    <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
    <![endif]-->

</head>
<body>
    <div class="wrapper-page">
        <div class="text-center">
            <a class="logo-lg"><span>תומר גלפנד - תכנון וביצוע פרוייקטים</span></a>
        </div>
        <form id="loginForm" class="form-horizontal m-t-20" role="form" action="index.html">
            <div class="form-group">
                <div class="input-group">
                    <div class="input-group-prepend">
                        <span class="input-group-text"><i class="mdi mdi-account"></i></span>
                    </div>
                    <input id="userName" name="userName" class="form-control" type="text" placeholder="שם משתמש">
                </div>
            </div>
            <div class="form-group row">
                <div class="col-12">
                    <div class="input-group">
                        <div class="input-group-prepend">
                            <span class="input-group-text"><i class="mdi mdi-key"></i></span>
                        </div>
                        <input id="password" name="password" class="form-control" type="password" placeholder="סיסמא">
                    </div>
                </div>
            </div>
            <div class="form-group text-right m-t-20">
                <button id="loginBTN" class="btn btn-primary btn-custom w-md waves-effect waves-light" type="submit">התחבר</button>
            </div>
        </form>
    </div>

    <script>
        var resizefunc = [];
    </script>

    <script>
        $(document).ready(function () {
            // DO NOT REMOVE : GLOBAL FUNCTIONS!
            var errorClass = 'invalid';
            var errorElement = 'em';
            var $loginForm = $('#loginForm').validate({
                highlight: function (element) {
                    jQuery(element).closest('.form-group').addClass('has-error');
                },
                unhighlight: function (element) {
                    jQuery(element).closest('.form-group').removeClass('has-error');
                },

                // Rules for form validation
                rules: {
                    userName: {
                        required: true
                    },
                    password: {
                        required: true
                    }
                },

                submitHandler: function (form, event) {
                    event.preventDefault();
                    //START OF login check code
                    userName = $("#userName").val();
                    password = $("#password").val();
                    setCookie("username", userName, 1 / 24);
                    var request = { userName: userName, password: password };
                    //call the ajax func
                    loginCheck(request, LoginCheckCB, LoginCheckErrorCB);
                },

                // Messages for form validation
                messages: {
                    userName: {
                        required: "אנא הכנס שם משתמש"
                    },
                    password: {
                        required: "אנא הכנס סיסמא"
                    }
                }
            });

            function LoginCheckCB(result) {
                var user = JSON.parse(result.d);
                localStorage.employee = JSON.stringify(user);
                if (user.User_name) {
                    swal({
                        title: "ברוך הבא",
                        type: "success",
                        timer: 1000,
                        showConfirmButton: false
                    });
                    setTimeout(function () {
                        location.href = "index.html";
                    }, 1001);
                }
                else {
                    swal({
                        title: "שם משתמש או סיסמא שגוי",
                        type: "warning",
                        timer: 1000,
                        showConfirmButton: false
                    });
                }
            }

            function LoginCheckErrorCB(error) {
                console.log(error);
            }
        });

    </script>

    <!-- Plugins  -->
    <script src="../assets/js/external_utils/jquery.min.js"></script>
    <script src="../assets/js/external_utils/popper.min.js"></script><!-- Popper for Bootstrap -->
    <script src="../assets/js/external_utils/bootstrap.min.js"></script>
    <script src="../assets/js/external_utils/detect.js"></script>
    <script src="../assets/js/external_utils/fastclick.js"></script>
    <script src="../assets/js/external_utils/jquery.slimscroll.js"></script>
    <script src="../assets/js/external_utils/jquery.blockUI.js"></script>
    <script src="../assets/js/external_utils/waves.js"></script>
    <script src="../assets/js/external_utils/wow.min.js"></script>
    <script src="../assets/js/external_utils/jquery.nicescroll.js"></script>
    <script src="../assets/js/external_utils/jquery.scrollTo.min.js"></script>
    <script src="../assets/plugins/switchery/switchery.min.js"></script>

    <!--Validation-->
    <script src="../assets/plugins/jquery-validation/js/jquery.validate.min.js"></script>

    <!-- Sweet Alert Js  -->
    <script src="../assets/plugins/sweet-alert/sweetalert2.min.js"></script>
    <script src="../assets/pages/jquery.sweet-alert.init.js"></script>

    <!-- Custom main Js -->
    <script src="../assets/js/external_utils/jquery.core.js"></script>
    <script src="../assets/js/external_utils/jquery.app.js"></script>

</body>
</html>